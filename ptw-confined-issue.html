<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Issue Permit - PTW Management System</title>
  <link rel="stylesheet" href="css/ptw-confined-styles.css">
  <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
</head>
<body>
  <div class="container">
    <img id="logoImage" src="img/logo.jpg" alt="TCG Lifesciences Logo" style="display:block; margin: 0 auto; width: 200px; height: auto;">
    <div id="capture-section" class="container">
      <header style="text-align: center; margin-bottom: 20px;">
        <h1>TCG Lifesciences Pvt. Ltd.</h1>
        <h2 style="text-align: center;">ISSUE CONFINED SPACE WORK PERMIT</h2>
      </header>
      <main id="content">
        <ol>
          <li>This permit must be completed and certified by the responsible person of performing/permitting before any person is allowed to enter into a confined space as required by Section 36, 36A & 37 of Factories Act - 1948.</li>
          <li>This permit must be displayed near the entrance of confined space during the work.</li>
          <li>Site conditions must be checked personally.</li>
          <li>This permit shall be issued by Responsible work In-charge head / designee.</li>
          <li>This permit is valid for the time mentioned on the permit.</li>
          <li>This permit shall be closed after completion / non-completion of work. (At the end of the day)</li>
        </ol>

        <form id="ptwForm">
          <div class="form-group no-print">
            <label for="generalPtwNumber">General PTW Number:</label>
            <select id="generalPtwNumber" name="generalPtwNumber" required>
              <option value="">Select General PTW Number</option>
              <!-- Options will be dynamically populated -->
            </select>
          </div>
          <div class="form-group">
            <label for="ptwNumber">PTW Number:</label>
            <input type="text" id="ptwNumber" name="ptwNumber" readonly>
          </div>
          <div class="form-group">
            <label for="date">Date:</label>
            <input type="date" id="date" name="date" required>
          </div>
          <div class="form-group">
            <label for="issueTimeFrom">From Time:</label>
            <input type="time" id="issueTimeFrom" name="issueTimeFrom">
          </div>
          <div class="form-group">
            <label for="issueTimeTo">To Time:</label>
            <input type="time" id="issueTimeTo" name="issueTimeTo">
          </div>
          <div class="form-group">
            <label for="requestingDepartment">Requesting Department/Section:</label>
            <input type="text" id="requestingDepartment" name="requestingDepartment" required>
          </div>
          <div class="form-group">
            <label for="jobDescription">Job Description:</label>
            <input type="text" id="jobDescription" name="jobDescription" required>
          </div>
          <div class="form-group">
            <label for="requestingPersonnel">Permit issued to (Shift / Area in charge):</label>
            <select id="requestingPersonnel" name="requestingPersonnel" required>
              <option value="">Select Name</option>
              <!-- Options will be dynamically populated -->
            </select>
          </div>
          <div class="form-group">
            <label for="contractor">Name of Agency / Contractor:</label>
            <select id="contractor" name="contractor" required>
              <option value="">Select Contractor</option>
              <!-- Options will be dynamically populated -->
            </select>
          </div>
          <div class="form-group">
            <label for="contractorSupervisor">Contractor Supervisor Name:</label>
            <select id="contractorSupervisor" name="contractorSupervisor" required>
              <option value="">Select Supervisor</option>
              <!-- Options will be dynamically populated -->
            </select>
          </div>

          <!-- Dynamic Check Points -->
          <table>
            <thead>
              <tr>
                <th>Check Points (before starting the job)</th>
                <th>Tick (âˆš)</th>
                <th>Remarks</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>1. Equipment is drained / flushed and free from material, verified top cover of the reactors.</td>
                <td><input type="checkbox" id="drainedFlushed" name="drainedFlushed"></td>
                <td><input type="text" id="drainedFlushedRemarks" name="drainedFlushedRemarks"></td>
              </tr>
              <tr>
                <td>2. Air purging, steaming carried out, vessel is cleaned & free from flammable / toxic material.</td>
                <td><input type="checkbox" id="airPurging" name="airPurging"></td>
                <td><input type="text" id="airPurgingRemarks" name="airPurgingRemarks"></td>
              </tr>
              <tr>
                <td>3. Equipment / vessel isolated by blinding, disconnected.</td>
                <td><input type="checkbox" id="equipmentIsolated" name="equipmentIsolated"></td>
                <td><input type="text" id="equipmentIsolatedRemarks" name="equipmentIsolatedRemarks"></td>
              </tr>
              <tr>
                <td>4. Has work area been made safe, including access too.</td>
                <td><input type="checkbox" id="workAreaSafe" name="workAreaSafe"></td>
                <td><input type="text" id="workAreaSafeRemarks" name="workAreaSafeRemarks"></td>
              </tr>
              <tr>
                <td>5. Equipment is isolated from drive by disconnecting electrical motor or removing belt followed by LOTO.</td>
                <td><input type="checkbox" id="equipmentIsolatedDrive" name="equipmentIsolatedDrive"></td>
                <td><input type="text" id="equipmentIsolatedDriveRemarks" name="equipmentIsolatedDriveRemarks"></td>
              </tr>
              <tr>
                <td>6. 24V DC lamp for lighting the vessel is provided.</td>
                <td><input type="checkbox" id="lightingProvided" name="lightingProvided"></td>
                <td><input type="text" id="lightingProvidedRemarks" name="lightingProvidedRemarks"></td>
              </tr>
              <tr>
                <td>7. Person involved is fully instructed regarding possible hazards.</td>
                <td><input type="checkbox" id="personInstructed" name="personInstructed"></td>
                <td><input type="text" id="personInstructedRemarks" name="personInstructedRemarks"></td>
              </tr>
              <tr>
                <td>8. Ventilation is ensured with exhaust or forced fan.</td>
                <td><input type="checkbox" id="ventilationEnsured" name="ventilationEnsured"></td>
                <td><input type="text" id="ventilationEnsuredRemarks" name="ventilationEnsuredRemarks"></td>
              </tr>
              <tr>
                <td>9. An attendant deployed outside for communication with the inside person unless the job is completed.</td>
                <td><input type="checkbox" id="attendantDeployed" name="attendantDeployed"></td>
                <td><input type="text" id="attendantDeployedRemarks" name="attendantDeployedRemarks"></td>
              </tr>
              <tr>
                <td>10. Other precautions if any:</td>
                <td><textarea id="otherPrecautions" name="otherPrecautions" rows="3"></textarea></td>
                <td></td>
              </tr>
            </tbody>
          </table>

          <h2>Air Monitoring Results Prior to Entry</h2>
          <table>
            <tr>
              <td>Monitor type:</td>
              <td><input type="text" id="monitorType" name="monitorType"></td>
              <td>Serial No.:</td>
              <td><input type="text" id="serialNumber" name="serialNumber"></td>
            </tr>
            <tr>
              <td>Oxygen:</td>
              <td><input type="text" id="oxygen" name="oxygen"></td>
              <td>%LEL:</td>
              <td><input type="text" id="lel" name="lel"></td>
            </tr>
            <tr>
              <td>Calibration performed? Initials:</td>
              <td colspan="3"><input type="text" id="calibrationInitials" name="calibrationInitials"></td>
            </tr>
            <tr>
              <td>Alarm Condition?</td>
              <td colspan="3"><input type="text" id="alarmCondition" name="alarmCondition"></td>
            </tr>
            <tr>
              <td>Monitoring performed by (sign):</td>
              <td><input type="text" id="monitoringSign" name="monitoringSign"></td>
              <td>Date:</td>
              <td><input type="date" id="monitoringDate" name="monitoringDate"></td>
            </tr>
          </table>

          <!-- Certification section -->
          <div class="certification-section">
            <p>We certify that the above measures have been taken and the area equipment is free from combustible, flammable, toxic, and dangerous fumes and that it is safe to carry out the work and concerned persons have been instructed accordingly. Site conditions have been checked by me personally.</p>
          </div>

          <!-- Permit Issuance Section -->
          <div class="section permit-issuer">
            <h2>Permit Issuance</h2>
            <div class="form-group">
              <label for="requesterSignatureSelect">Select Permit Requester:</label>
              <select id="requesterSignatureSelect" name="requesterSignatureSelect" required>
                <option value="">Select Name</option>
                <!-- Options will be dynamically populated -->
              </select>
              <label for="requesterSignature">Signature of Permit Requester:</label>
              <canvas id="requesterSignatureCanvas" class="signature-canvas"></canvas>
              <button type="button" class="btn-clear" onclick="clearCanvas('requesterSignatureCanvas')">Clear</button>
            </div>
            <div class="form-group">
              <label for="issuerName">Permit Issuer (Logged in User):</label>
              <input type="text" id="issuerName" name="issuerName" readonly>
              <label for="issuerSignature">Signature of Permit Issuer:</label>
              <canvas id="issuerSignatureCanvas" class="signature-canvas"></canvas>
              <button type="button" class="btn-clear" onclick="clearCanvas('issuerSignatureCanvas')">Clear</button>
            </div>
            <div class="form-group">
              <label for="ehsSignatureSelect">Select EHS Department Head/Designee:</label>
              <select id="ehsSignatureSelect" name="ehsSignatureSelect" required>
                <option value="">Select Name</option>
                <!-- Options will be dynamically populated -->
              </select>
              <label for="ehsSignature">Signature of EHS Department Head/Designee:</label>
              <canvas id="ehsSignatureCanvas" class="signature-canvas"></canvas>
              <button type="button" class="btn-clear" onclick="clearCanvas('ehsSignatureCanvas')">Clear</button>
            </div>
            <div class="form-group">
              <label for="contractorSupervisorsignature">Contractor Supervisor Name:</label>
              <select id="contractorSupervisorsignature" name="contractorSupervisorsignature" required>
                <option value="">Select Supervisor</option>
                <!-- Options will be dynamically populated -->
              </select>
              <label for="contractorSupervisorSignature">Signature of Contractor Supervisor:</label>
              <canvas id="contractorSupervisorSignatureCanvas" class="signature-canvas"></canvas>
              <button type="button" class="btn-clear" onclick="clearCanvas('contractorSupervisorSignatureCanvas')">Clear</button>
            </div>
          </div>
	</div>
          <button type="submit">Submit PTW</button>
          <button type="button" onclick="location.href='ptw-issue-dashboard.html'">Back</button>
        </form>
      </main>    
  
  <div id="loadingOverlay">
    <p>Please wait, saving your document...</p>
  </div>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-firestore.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-storage.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="js/firebase-config.js"></script>
  <script src="js/populateForm_issue.js"></script>
  <script src="js/signatureCanvas_issue.js"></script>
  <script src="js/ptw-confined-issue.js"></script>
</body>
</html>
